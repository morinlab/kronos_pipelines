__PIPELINE_INFO__:
    name: titan
    version: 5.0
    tag: 'cycle008'
    author: Diljot Grewal <dgrewal@bccrc.ca>
    data_type: ['titan', 'titan_support']
    input_type: bam
    output_type: 'params.txt, .RData, seg, segs.txt, segs.txt.pygenes, titan.txt'
    host_cluster: null
    date_created: October 30 2014
    date_last_updated: 16 Apr 2015 by jrosner
    factory_version: '1.12.0'


__GENERAL__:
    python: '$$LOHR_PROJECT_HOME/software/anaconda-2.3.0/bin/python'
    R: '$$LOHR_PROJECT_HOME/software/R-3.2.1/bin/R'
    mutationseq: '$$LOHR_PROJECT_HOME/software/mutationseq/museq/'


__SHARED__:
    setup_env: '. /projects/lohr_prj/env.sh'
    ld_library_path: ""
    reference: '$$LOHR_PROJECT_HOME/reference/Homo_sapiens_assembly19_EBV.fasta'
    positions_file: '$$LOHR_PROJECT_HOME/reference/common_all_dbSNP138.pos'
    map: '$$LOHR_PROJECT_HOME/reference/GRCh37-lite.map.ws_1000.wig'
    gc: '$$LOHR_PROJECT_HOME/reference/GRCh37-lite.gc.ws_1000.wig'
    # r_libs: '$$LOHR_PROJECT_HOME/software/titancna/1.8.0/morinlab/package_titancna_1_8_0/ef9c956aa477:$$LOHR_PROJECT_HOME/software/R-3.2.1/lib/R/library'
    r_libs: "$$LOHR_PROJECT_HOME/software/R-3.2.1/lib/R/library"
    y_threshold: '20'
    target_list: '$$LOHR_PROJECT_HOME/reference/agilent_sureselect_all_exons_v5_and_utr.sort.merge.bed'
    genome_type: 'NCBI'
    model: 'model_single_v4.0.2.npz'


__SAMPLES__:
    LS1065:
        tumour: "$$LOHR_PROJECT_HOME/data/LS1065.bam"
        tumour_id: "LS1065"
        normal: "$$LOHR_PROJECT_HOME/data/LS1065N.bam"
        normal_id: "LS1065N"
    LS1098:
        tumour: "$$LOHR_PROJECT_HOME/data/LS1098.bam"
        tumour_id: "LS1098"
        normal: "$$LOHR_PROJECT_HOME/data/LS1098N.bam"
        normal_id: "LS1098N"
    LS1395:
        tumour: "$$LOHR_PROJECT_HOME/data/LS1395.bam"
        tumour_id: "LS1395"
        normal: "$$LOHR_PROJECT_HOME/data/LS1395N.bam"
        normal_id: "LS1395N"
    LS146:
        tumour: "$$LOHR_PROJECT_HOME/data/LS146.bam"
        tumour_id: "LS146"
        normal: "$$LOHR_PROJECT_HOME/data/LS146N.bam"
        normal_id: "LS146N"
    LS148:
        tumour: "$$LOHR_PROJECT_HOME/data/LS148.bam"
        tumour_id: "LS148"
        normal: "$$LOHR_PROJECT_HOME/data/LS148N.bam"
        normal_id: "LS148N"
    LS1546:
        tumour: "$$LOHR_PROJECT_HOME/data/LS1546.bam"
        tumour_id: "LS1546"
        normal: "$$LOHR_PROJECT_HOME/data/LS1546N.bam"
        normal_id: "LS1546N"
    LS155:
        tumour: "$$LOHR_PROJECT_HOME/data/LS155.bam"
        tumour_id: "LS155"
        normal: "$$LOHR_PROJECT_HOME/data/LS155N.bam"
        normal_id: "LS155N"
    LS1583:
        tumour: "$$LOHR_PROJECT_HOME/data/LS1583.bam"
        tumour_id: "LS1583"
        normal: "$$LOHR_PROJECT_HOME/data/LS1583N.bam"
        normal_id: "LS1583N"
    LS1620:
        tumour: "$$LOHR_PROJECT_HOME/data/LS1620.bam"
        tumour_id: "LS1620"
        normal: "$$LOHR_PROJECT_HOME/data/LS1620N.bam"
        normal_id: "LS1620N"
    LS1668:
        tumour: "$$LOHR_PROJECT_HOME/data/LS1668.bam"
        tumour_id: "LS1668"
        normal: "$$LOHR_PROJECT_HOME/data/LS1668N.bam"
        normal_id: "LS1668N"
    LS1683:
        tumour: "$$LOHR_PROJECT_HOME/data/LS1683.bam"
        tumour_id: "LS1683"
        normal: "$$LOHR_PROJECT_HOME/data/LS1683N.bam"
        normal_id: "LS1683N"
    LS1757:
        tumour: "$$LOHR_PROJECT_HOME/data/LS1757.bam"
        tumour_id: "LS1757"
        normal: "$$LOHR_PROJECT_HOME/data/LS1757N.bam"
        normal_id: "LS1757N"
    LS1899:
        tumour: "$$LOHR_PROJECT_HOME/data/LS1899.bam"
        tumour_id: "LS1899"
        normal: "$$LOHR_PROJECT_HOME/data/LS1899N.bam"
        normal_id: "LS1899N"
    LS1921:
        tumour: "$$LOHR_PROJECT_HOME/data/LS1921.bam"
        tumour_id: "LS1921"
        normal: "$$LOHR_PROJECT_HOME/data/LS1921N.bam"
        normal_id: "LS1921N"
    LS2089:
        tumour: "$$LOHR_PROJECT_HOME/data/LS2089.bam"
        tumour_id: "LS2089"
        normal: "$$LOHR_PROJECT_HOME/data/LS2089N.bam"
        normal_id: "LS2089N"
    LS2154:
        tumour: "$$LOHR_PROJECT_HOME/data/LS2154.bam"
        tumour_id: "LS2154"
        normal: "$$LOHR_PROJECT_HOME/data/LS2154N.bam"
        normal_id: "LS2154N"
    LS2208:
        tumour: "$$LOHR_PROJECT_HOME/data/LS2208.bam"
        tumour_id: "LS2208"
        normal: "$$LOHR_PROJECT_HOME/data/LS2208N.bam"
        normal_id: "LS2208N"
    LS2245:
        tumour: "$$LOHR_PROJECT_HOME/data/LS2245.bam"
        tumour_id: "LS2245"
        normal: "$$LOHR_PROJECT_HOME/data/LS2245N.bam"
        normal_id: "LS2245N"
    LS2258:
        tumour: "$$LOHR_PROJECT_HOME/data/LS2258.bam"
        tumour_id: "LS2258"
        normal: "$$LOHR_PROJECT_HOME/data/LS2258N.bam"
        normal_id: "LS2258N"
    LS2264:
        tumour: "$$LOHR_PROJECT_HOME/data/LS2264.bam"
        tumour_id: "LS2264"
        normal: "$$LOHR_PROJECT_HOME/data/LS2264N.bam"
        normal_id: "LS2264N"
    LS2305:
        tumour: "$$LOHR_PROJECT_HOME/data/LS2305.bam"
        tumour_id: "LS2305"
        normal: "$$LOHR_PROJECT_HOME/data/LS2305N.bam"
        normal_id: "LS2305N"
    LS2328:
        tumour: "$$LOHR_PROJECT_HOME/data/LS2328.bam"
        tumour_id: "LS2328"
        normal: "$$LOHR_PROJECT_HOME/data/LS2328N.bam"
        normal_id: "LS2328N"
    LS2357:
        tumour: "$$LOHR_PROJECT_HOME/data/LS2357.bam"
        tumour_id: "LS2357"
        normal: "$$LOHR_PROJECT_HOME/data/LS2357N.bam"
        normal_id: "LS2357N"
    LS2367:
        tumour: "$$LOHR_PROJECT_HOME/data/LS2367.bam"
        tumour_id: "LS2367"
        normal: "$$LOHR_PROJECT_HOME/data/LS2367N.bam"
        normal_id: "LS2367N"
    LS2590:
        tumour: "$$LOHR_PROJECT_HOME/data/LS2590.bam"
        tumour_id: "LS2590"
        normal: "$$LOHR_PROJECT_HOME/data/LS2590N.bam"
        normal_id: "LS2590N"
    LS2596:
        tumour: "$$LOHR_PROJECT_HOME/data/LS2596.bam"
        tumour_id: "LS2596"
        normal: "$$LOHR_PROJECT_HOME/data/LS2596N.bam"
        normal_id: "LS2596N"
    LS2599:
        tumour: "$$LOHR_PROJECT_HOME/data/LS2599.bam"
        tumour_id: "LS2599"
        normal: "$$LOHR_PROJECT_HOME/data/LS2599N.bam"
        normal_id: "LS2599N"
    LS2978:
        tumour: "$$LOHR_PROJECT_HOME/data/LS2978.bam"
        tumour_id: "LS2978"
        normal: "$$LOHR_PROJECT_HOME/data/LS2978N.bam"
        normal_id: "LS2978N"
    LS297:
        tumour: "$$LOHR_PROJECT_HOME/data/LS297.bam"
        tumour_id: "LS297"
        normal: "$$LOHR_PROJECT_HOME/data/LS297N.bam"
        normal_id: "LS297N"
    LS3200:
        tumour: "$$LOHR_PROJECT_HOME/data/LS3200.bam"
        tumour_id: "LS3200"
        normal: "$$LOHR_PROJECT_HOME/data/LS3200N.bam"
        normal_id: "LS3200N"
    LS3204:
        tumour: "$$LOHR_PROJECT_HOME/data/LS3204.bam"
        tumour_id: "LS3204"
        normal: "$$LOHR_PROJECT_HOME/data/LS3204N.bam"
        normal_id: "LS3204N"
    LS3245:
        tumour: "$$LOHR_PROJECT_HOME/data/LS3245.bam"
        tumour_id: "LS3245"
        normal: "$$LOHR_PROJECT_HOME/data/LS3245N.bam"
        normal_id: "LS3245N"
    LS3271:
        tumour: "$$LOHR_PROJECT_HOME/data/LS3271.bam"
        tumour_id: "LS3271"
        normal: "$$LOHR_PROJECT_HOME/data/LS3271N.bam"
        normal_id: "LS3271N"
    LS3309:
        tumour: "$$LOHR_PROJECT_HOME/data/LS3309.bam"
        tumour_id: "LS3309"
        normal: "$$LOHR_PROJECT_HOME/data/LS3309N.bam"
        normal_id: "LS3309N"
    LS3387:
        tumour: "$$LOHR_PROJECT_HOME/data/LS3387.bam"
        tumour_id: "LS3387"
        normal: "$$LOHR_PROJECT_HOME/data/LS3387N.bam"
        normal_id: "LS3387N"
    LS3499:
        tumour: "$$LOHR_PROJECT_HOME/data/LS3499.bam"
        tumour_id: "LS3499"
        normal: "$$LOHR_PROJECT_HOME/data/LS3499N.bam"
        normal_id: "LS3499N"
    LS3615:
        tumour: "$$LOHR_PROJECT_HOME/data/LS3615.bam"
        tumour_id: "LS3615"
        normal: "$$LOHR_PROJECT_HOME/data/LS3615N.bam"
        normal_id: "LS3615N"
    LS3749:
        tumour: "$$LOHR_PROJECT_HOME/data/LS3749.bam"
        tumour_id: "LS3749"
        normal: "$$LOHR_PROJECT_HOME/data/LS3749N.bam"
        normal_id: "LS3749N"
    LS378:
        tumour: "$$LOHR_PROJECT_HOME/data/LS378.bam"
        tumour_id: "LS378"
        normal: "$$LOHR_PROJECT_HOME/data/LS378N.bam"
        normal_id: "LS378N"
    LS3808:
        tumour: "$$LOHR_PROJECT_HOME/data/LS3808.bam"
        tumour_id: "LS3808"
        normal: "$$LOHR_PROJECT_HOME/data/LS3808N.bam"
        normal_id: "LS3808N"
    LS3820:
        tumour: "$$LOHR_PROJECT_HOME/data/LS3820.bam"
        tumour_id: "LS3820"
        normal: "$$LOHR_PROJECT_HOME/data/LS3820N.bam"
        normal_id: "LS3820N"
    LS3866:
        tumour: "$$LOHR_PROJECT_HOME/data/LS3866.bam"
        tumour_id: "LS3866"
        normal: "$$LOHR_PROJECT_HOME/data/LS3866N.bam"
        normal_id: "LS3866N"
    LS4085:
        tumour: "$$LOHR_PROJECT_HOME/data/LS4085.bam"
        tumour_id: "LS4085"
        normal: "$$LOHR_PROJECT_HOME/data/LS4085N.bam"
        normal_id: "LS4085N"
    LS420:
        tumour: "$$LOHR_PROJECT_HOME/data/LS420.bam"
        tumour_id: "LS420"
        normal: "$$LOHR_PROJECT_HOME/data/LS420N.bam"
        normal_id: "LS420N"
    LS762:
        tumour: "$$LOHR_PROJECT_HOME/data/LS762.bam"
        tumour_id: "LS762"
        normal: "$$LOHR_PROJECT_HOME/data/LS762N.bam"
        normal_id: "LS762N"
    LS843:
        tumour: "$$LOHR_PROJECT_HOME/data/LS843.bam"
        tumour_id: "LS843"
        normal: "$$LOHR_PROJECT_HOME/data/LS843N.bam"
        normal_id: "LS843N"
    LS88:
        tumour: "$$LOHR_PROJECT_HOME/data/LS88.bam"
        tumour_id: "LS88"
        normal: "$$LOHR_PROJECT_HOME/data/LS88N.bam"
        normal_id: "LS88N"
    LS951:
        tumour: "$$LOHR_PROJECT_HOME/data/LS951.bam"
        tumour_id: "LS951"
        normal: "$$LOHR_PROJECT_HOME/data/LS951N.bam"
        normal_id: "LS951N"


__TASK_MUTATIONSEQ__:
    reserved:
        # do not change this section
        component_name: 'run_mutationseq'
        component_version: '1.0.5'
        seed_version: '4.3.7'
    run:
        use_cluster: True
        memory: '10G'
        num_cpus: 1
        forced_dependencies: []
        add_breakpoint: False
        env_vars:
            LD_LIBRARY_PATH: ('__SHARED__', 'ld_library_path')
        boilerplate: ('__SHARED__', 'setup_env')
        parallel_run: False
        parallel_params: []
        interval_file:
    component:
        input_files:
            tumour: ('__SAMPLES__', 'tumour')
            reference: ('__SHARED__', 'reference')
            positions_file: ('__SHARED__', 'positions_file')
            normal: ('__SAMPLES__', 'normal')
            model: ('__SHARED__','model')
            config: 'metadata.config'
        output_files:
            export_features: null
            out: run_mutationseq/MutationSeq_SS.vcf
            log_file: ../logs/mutationSeq_run.log
        parameters:
            all: False
            features_only: False
            verbose: True
            manifest: '__OPTIONAL__'
            interval: null
            titan_mode: True
            deep: False
            no_filter: False
            normalized: False
            coverage: 4
            threshold: 0.50
            buffer_size: '2G'


__TASK_CONVERT_VCF2COUNTS__:
    reserved:
        # do not change this section
        component_name: 'convert_museq_vcf2counts'
        component_version: '1.1.2'
        seed_version: '1.1.0'
    run:
        # NOTE: component cannot run in parallel mode.
        use_cluster: True
        memory: '5G'
        num_cpus: 1
        forced_dependencies: []
        add_breakpoint: False
        env_vars:
            LD_LIBRARY_PATH: ('__SHARED__', 'ld_library_path')
        boilerplate: ('__SHARED__', 'setup_env')
    component:
        input_files:
            infile: ('__TASK_MUTATIONSEQ__', 'out')
            positions_file: null
        output_files:
            outfile: 'museq2counts/output_museq_postprocess.txt'
        parameters:


__TASK_READCOUNTER_TUMOUR__:
    reserved:
        # do not change this section
        component_name: 'run_readcounter'
        component_version: '1.1.2'
        seed_version: '1.0.0'
    run:
        # NOTE: component cannot run in parallel mode.
        use_cluster: True
        memory: '5G'
        num_cpus: 1
        forced_dependencies: []
        add_breakpoint: False
        env_vars:
            LD_LIBRARY_PATH: ('__SHARED__', 'ld_library_path')
        boilerplate: ('__SHARED__', 'setup_env')
    component:
        input_files:
            bam: ('__SAMPLES__', 'tumour')
        output_files:
            out: 'run_readcounter/tumour.wig'
        parameters:
            q: '0'
            w: '1000'
            chromosomes: null
            run_component: True


__TASK_READCOUNTER_NORMAL__:
    reserved:
        # do not change this section
        component_name: 'run_readcounter'
        component_version: '1.1.2'
        seed_version: '1.0.0'
    run:
        # NOTE: component cannot run in parallel mode.
        use_cluster: True
        memory: '5G'
        num_cpus: 1
        forced_dependencies: []
        add_breakpoint: False
        env_vars:
            LD_LIBRARY_PATH: ('__SHARED__', 'ld_library_path')
        boilerplate: ('__SHARED__', 'setup_env')
    component:
        input_files:
            bam: ('__SAMPLES__', 'normal')
        output_files:
            out: 'run_readcounter/normal.wig'
        parameters:
            q: '0'
            w: '1000'
            chromosomes: null
            run_component: True


__TASK_CALC_CORRECTREADS__:
    reserved:
        # do not change this section
        component_name: 'calc_correctreads_wig'
        component_version: '1.1.2'
        seed_version: '0.1.1'
    run:
        # NOTE: component cannot run in parallel mode.
        use_cluster: True
        memory: '5G'
        num_cpus: 1
        forced_dependencies: []
        add_breakpoint: False
        env_vars:
            R_LIBS: ('__SHARED__', 'r_libs')
        boilerplate: ('__SHARED__', 'setup_env')
    component:
        input_files:
            map: ('__SHARED__','map')
            tumwig: ('__TASK_READCOUNTER_TUMOUR__', 'out')
            gc: ('__SHARED__','gc')
            normwig: ('__TASK_READCOUNTER_NORMAL__', 'out')
            target_list: ('__SHARED__', 'target_list')
        output_files:
            outfile: 'calc_correctreads_wig/correct_reads.txt'
        parameters:
            id: $sample_id
            hmmcopy: null
            run_component: True
            genome_type: ('__SHARED__','genome_type')


__TASK_TITAN__:
    reserved:
        # do not change this section
        component_name: 'run_titan'
        component_version: '1.1.2'
        seed_version: '0.1.1'
    run:
        # NOTE: component cannot run in parallel mode.
        use_cluster: True
        memory: '25G'
        num_cpus: 1
        forced_dependencies: []
        add_breakpoint: False
        env_vars:
            R_LIBS: ('__SHARED__', 'r_libs')
        boilerplate: ('__SHARED__', 'setup_env')
        parallel_run: False
        parallel_params: []
        interval_file: '$$LOHR_PROJECT_HOME/software/titan_pipeline/interval_file_titan.txt'
    component:
        input_files:
            map: ('__SHARED__', 'map')
            infile: ('__TASK_CONVERT_VCF2COUNTS__', 'outfile')
            cnfile: ('__TASK_CALC_CORRECTREADS__', 'outfile')
        output_files:
            outfile: 'results/${sample_id}_titan_outfile.txt'
            obj_outfile: 'run_titan/titan_outfile_obj.RData'
            outparam: 'results/${sample_id}_titan_outfile_params.txt'
        parameters:
            txn_z_strength: '1e6'
            norm_est_meth: 'map'
            pseudo_counts: '1e-300'
            num_cores: '1'
            n_zero: '0.5'
            myskew: '0'
            max_i: '50'
            alpha_high: '20000'
            bool_est_ploidy: 'TRUE'
            sym: 'TRUE'
            alpha_k: '2500'
            txn_exp_len: '1e16'
            num_clusters: "1"
            ploidy: 2
            maxcn: '8'
            id: $sample_id
            genome_type: ('__SHARED__','genome_type')
            chromosomes: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y]
            y_threshold: ('__SHARED__','y_threshold')


__TASK_CALC_CNSEGMENTS__:
    reserved:
        # do not change this section
        component_name: 'calc_cnsegments_titan'
        component_version: '1.1.1'
        seed_version: '0.1.2'
    run:
        # NOTE: component cannot run in parallel mode.
        use_cluster: True
        memory: '2G'
        forced_dependencies: []
        add_breakpoint: False
        env_vars:
        boilerplate: ('__SHARED__', 'setup_env')
        parallel_run: False
        parallel_params: ['infile']
        interval_file:
    component:
        input_files:
            infile: ('__TASK_TITAN__', 'outfile')
        output_files:
            outigv: 'calc_cnsegments_titan/outigv.seg'
            outfile: 'calc_cnsegments_titan/segs.txt'
        parameters:
            id: $sample_id
            symmetric: "1"
